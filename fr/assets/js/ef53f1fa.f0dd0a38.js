"use strict";(self.webpackChunkadguard_dns_knowledge_base=self.webpackChunkadguard_dns_knowledge_base||[]).push([[588],{4137:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return c}});var n=a(7294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=s(a),c=l,k=u["".concat(p,".").concat(c)]||u[c]||d[c]||r;return a?n.createElement(k,i(i({ref:t},m),{},{components:a})):n.createElement(k,i({ref:t},m))}));function c(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,i=new Array(r);i[0]=u;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:l,i[1]=o;for(var s=2;s<r;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},1964:function(e,t,a){a.r(t),a.d(t,{assets:function(){return m},contentTitle:function(){return p},default:function(){return c},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return d}});var n=a(3117),l=a(102),r=(a(7294),a(4137)),i=["components"],o={title:"Syntaxe des r\xe8gles de filtrage DNS",sidebar_position:2,toc_min_heading_level:2,toc_max_heading_level:4},p=void 0,s={unversionedId:"general/dns-filtering-syntax",id:"general/dns-filtering-syntax",title:"Syntaxe des r\xe8gles de filtrage DNS",description:"Nous vous montrons ici comment \xe9crire des r\xe8gles de filtrage DNS personnalis\xe9es \xe0 utiliser dans les produits AdGuard",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/general/dns-filtering-syntax.md",sourceDirName:"general",slug:"/general/dns-filtering-syntax",permalink:"/KnowledgeBaseDNS/fr/general/dns-filtering-syntax",draft:!1,editUrl:"https://github.com/AdguardTeam/KnowledgeBaseDNS/edit/master/docs/general/dns-filtering-syntax.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Syntaxe des r\xe8gles de filtrage DNS",sidebar_position:2,toc_min_heading_level:2,toc_max_heading_level:4},sidebar:"sidebar",previous:{title:"Filtrage DNS",permalink:"/KnowledgeBaseDNS/fr/general/dns-filtering"},next:{title:"Fournisseurs de DNS connus",permalink:"/KnowledgeBaseDNS/fr/general/dns-providers"}},m={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Basic Examples",id:"basic-examples",level:2},{value:"Adblock-Style Syntax",id:"adblock-style-syntax",level:2},{value:"Special Characters",id:"special-characters",level:3},{value:"Regular Expressions",id:"regular-expressions",level:3},{value:"Comments",id:"comments",level:3},{value:"Rule Modifiers",id:"rule-modifiers",level:3},{value:"<code>client</code>",id:"client",level:4},{value:"<code>denyallow</code>",id:"denyallow",level:4},{value:"<code>dnstype</code>",id:"dnstype",level:4},{value:"<code>dnsrewrite</code>",id:"dnsrewrite",level:4},{value:"<code>important</code>",id:"important",level:4},{value:"<code>badfilter</code>",id:"badfilter",level:4},{value:"<code>ctag</code>",id:"ctag",level:4},{value:"<code>/etc/hosts</code>-Style Syntaxe",id:"etc-hosts-syntax",level:2},{value:"Domains-Only Syntax",id:"domains-only-syntax",level:2},{value:"Hostlists Compiler",id:"hostlists-compiler",level:2}],u={toc:d};function c(e){var t=e.components,a=(0,l.Z)(e,i);return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Nous vous montrons ici comment \xe9crire des r\xe8gles de filtrage DNS personnalis\xe9es \xe0 utiliser dans les produits AdGuard"),(0,r.kt)("p",{parentName:"div"},"Liens rapides : ",(0,r.kt)("a",{parentName:"p",href:"https://adguard.com/download.html?auto=true&utm_source=kb_dns"},"T\xe9l\xe9charger le Bloqueur AdGuard"),", ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/AdGuardHome#getting-started"},"Obtenir AdGuard Home"),", ",(0,r.kt)("a",{parentName:"p",href:"https://adguard-dns.io/dashboard/"},"Essayer AdGuard DNS")))),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"You can use AdGuard DNS filtering rules syntax to make the rules more flexible, so they can block content according to your preferences. AdGuard DNS filtering rules syntax can be used in different AdGuard products such as AdGuard Home, AdGuard DNS, AdGuard for Windows/Mac/Android."),(0,r.kt)("p",null,"There are three different approaches to writing hosts blocklists:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"#adblock-style-syntax"},"Adblock-style syntax"),": the modern approach to writing filtering rules based on using a subset of the Adblock-style rule syntax. This way blocklists are compatible with browser ad blockers.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"#etc-hosts-syntax"},(0,r.kt)("inlineCode",{parentName:"a"},"/etc/hosts")," syntax"),": the old, tried-and-true approach that uses the same syntax that operating systems do for their hosts files.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"#domains-only-syntax"},"Domains-only syntax"),": a simple list of domain names."))),(0,r.kt)("p",null,"If you are creating a blocklist, we recommend using the ",(0,r.kt)("a",{parentName:"p",href:"#adblock-style-syntax"},"Adblock-style syntax"),". It has a couple of important advantages over the old-style syntax:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Blocklists size.")," Using pattern matching allows you to have a single rule instead of hundreds of ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/hosts")," entries.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Compatibility.")," Your blocklist will be compatible with browser ad blockers, and it will be easier to share rules with a browser filter list.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Extensibility.")," In the past decade, the Adblock-style syntax has greatly evolved, and we see no reason not to extend it even further and offer additional features for network-level blockers."))),(0,r.kt)("p",null,"If you're maintaining either a ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/hosts"),"-style blocklist or multiple filtering lists (regardless of type), we provide a tool for blocklist compilation. We named it ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/HostlistCompiler"},"Hostlist compiler")," and we use it ourselves to create ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/AdGuardSDNSFilter"},"AdGuard DNS filter"),"."),(0,r.kt)("h2",{id:"basic-examples"},"Basic Examples"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^"),": block access to the ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," domain and all its subdomains, like ",(0,r.kt)("inlineCode",{parentName:"p"},"www.example.org"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@||example.org^"),": unblock access to the ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," domain and all its subdomains.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"1.2.3.4 example.org"),": (attention, old ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/hosts"),"-style syntax) in AdGuard Home, respond with ",(0,r.kt)("inlineCode",{parentName:"p"},"1.2.3.4")," to queries for the ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," domain but ",(0,r.kt)("strong",{parentName:"p"},"not")," its subdomains. In Private AdGuard DNS, block access to ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org"),". ",(0,r.kt)("inlineCode",{parentName:"p"},"www.example.org")," remains allowed."),(0,r.kt)("p",{parentName:"li"},"In AdGuard Home, using the unspecified IP address (",(0,r.kt)("inlineCode",{parentName:"p"},"0.0.0.0"),") or a local address (",(0,r.kt)("inlineCode",{parentName:"p"},"127.0.0.1")," and alike) for a host is basically the same as blocking that host."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-none"},"# Returns the IP address 1.2.3.4 for example.org.\n1.2.3.4 example.org\n# Blocks example.org by responding with 0.0.0.0.\n0.0.0.0 example.org\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"example.org"),": a simple domain rule. Blocks the ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," domain but ",(0,r.kt)("strong",{parentName:"p"},"not")," its subdomains. ",(0,r.kt)("inlineCode",{parentName:"p"},"www.example.org")," remains allowed.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"! Here goes a comment")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"# Also a comment"),": comments.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"/REGEX/"),": block access to the domains matching the specified regular expression."))),(0,r.kt)("h2",{id:"adblock-style-syntax"},"Adblock-Style Syntax"),(0,r.kt)("p",null,"This is a subset of the ",(0,r.kt)("a",{parentName:"p",href:"https://adguard.com/kb/general/ad-filtering/create-own-filters/"},"traditional Adblock-style")," syntax which is used by browser ad blockers."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},'     rule = ["@@"] pattern [ "$" modifiers ]\nmodifiers = [modifier0, modifier1[, ...[, modifierN]]]\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"pattern"),": the hostname mask. Every hostname is matched against this mask. The pattern can also contain special characters, which are described below.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@"),": the marker that is used in the exception rules. Start your rule with this marker if you want to turn off filtering for the matching hostnames.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"modifiers"),": parameters that clarify the rule. They may limit the scope of the rule or even completely change the way it works."))),(0,r.kt)("h3",{id:"special-characters"},"Special Characters"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"*"),": the wildcard character. It is used to represent any set of characters. This can also be an empty string or a string of any length.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||"),": matches the beginning of a hostname, including any subdomain. For instance, ",(0,r.kt)("inlineCode",{parentName:"p"},"||example.org")," matches ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"test.example.org")," but not ",(0,r.kt)("inlineCode",{parentName:"p"},"testexample.org"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"^"),": the separator character. Unlike browser ad blocking, there's nothing to separate in a hostname, so the only purpose of this character is to mark the end of the hostname.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"|"),": a pointer to the beginning or the end of the hostname. The value depends on the character placement in the mask. For example, the rule ",(0,r.kt)("inlineCode",{parentName:"p"},"ample.org|")," corresponds to ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," but not to ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org.com"),". ",(0,r.kt)("inlineCode",{parentName:"p"},"|example")," corresponds to ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," but not to ",(0,r.kt)("inlineCode",{parentName:"p"},"test.example"),"."))),(0,r.kt)("h3",{id:"regular-expressions"},"Regular Expressions"),(0,r.kt)("p",null,"If you want even more flexibility in making rules, you can use ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions"},"regular expressions")," instead of the default simplified matching syntax. If you want to use a regular expression, the pattern has to look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},'pattern = "/" regexp "/"\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"/example.*/")," will block hosts matching the ",(0,r.kt)("inlineCode",{parentName:"p"},"example.*")," regexp.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@/example.*/$important")," will unblock hosts matching the ",(0,r.kt)("inlineCode",{parentName:"p"},"example.*")," regexp. Note that this rule also implies the ",(0,r.kt)("inlineCode",{parentName:"p"},"important")," modifier."))),(0,r.kt)("h3",{id:"comments"},"Comments"),(0,r.kt)("p",null,"Any line that starts with an exclamation mark or a hash sign is a comment and it will be ignored by the filtering engine. Comments are usually placed above rules and used to describe what a rule does."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"! This is a comment.\n# This is also a comment.\n")),(0,r.kt)("h3",{id:"rule-modifiers"},"Rule Modifiers"),(0,r.kt)("p",null,"You can change the behavior of a rule by adding modifiers. Modifiers must be located at the end of the rule after the ",(0,r.kt)("inlineCode",{parentName:"p"},"$")," character and be separated by commas."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-none",metastring:"||example.org^$important","||example.org^$important":!0},"")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^")," is the matching pattern. ",(0,r.kt)("inlineCode",{parentName:"p"},"$")," is the delimiter, which signals that the rest of the rule are modifiers. ",(0,r.kt)("inlineCode",{parentName:"p"},"important")," is the modifier.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"You may want to use multiple modifiers in a rule. In that case, separate them by commas:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-none"},"||example.org^$client=127.0.0.1,dnstype=A\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^")," is the matching pattern. ",(0,r.kt)("inlineCode",{parentName:"p"},"$")," is the delimiter, which signals that the rest of the rule are modifiers. ",(0,r.kt)("inlineCode",{parentName:"p"},"client=127.0.0.1")," is the ",(0,r.kt)("a",{parentName:"p",href:"#client"},(0,r.kt)("inlineCode",{parentName:"a"},"client"))," modifier with its value, ",(0,r.kt)("inlineCode",{parentName:"p"},"127.0.0.1"),", is the delimiter. And finally, ",(0,r.kt)("inlineCode",{parentName:"p"},"dnstype=A")," is the ",(0,r.kt)("a",{parentName:"p",href:"#dnstype"},(0,r.kt)("inlineCode",{parentName:"a"},"dnstype"))," modifier with its value, ",(0,r.kt)("inlineCode",{parentName:"p"},"A"),"."))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"NOTE:")," If a rule contains a modifier not listed in this document, the whole rule ",(0,r.kt)("strong",{parentName:"p"},"must be ignored"),". This way we avoid false-positives when people are trying to use unmodified browser ad blockers' filter lists like EasyList or EasyPrivacy."),(0,r.kt)("h4",{id:"client"},(0,r.kt)("inlineCode",{parentName:"h4"},"client")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"client")," modifier allows specifying clients this rule is applied to. There are two main ways to identify a client:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"By their IP address or CIDR prefix. This way works for all kinds of clients.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"By their name. This way only works for persistent clients (in AdGuard Home) and devices (in Private AdGuard DNS), which you have manually added."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"NOTE:")," In AdGuard Home, ClientIDs are not currently supported, only names are. If you have added a client with the name \u201cMy Client\u201d and ClientID ",(0,r.kt)("inlineCode",{parentName:"p"},"my-client")," spell your modifier as ",(0,r.kt)("inlineCode",{parentName:"p"},"$client='My Client'")," as opposed to ",(0,r.kt)("inlineCode",{parentName:"p"},"$client=my-client"),"."))),(0,r.kt)("p",null,"The syntax is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$client=value1|value2|...\n")),(0,r.kt)("p",null,"You can also exclude clients by adding a ",(0,r.kt)("inlineCode",{parentName:"p"},"~")," character before the value. In this case, the rule is not be applied to this client's DNS requests."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$client=~value1\n")),(0,r.kt)("p",null,"Client names usually contain spaces or other special characters, which is why you should enclose the name in quotes. Both single and double ASCII quotes are supported. Use the backslash (",(0,r.kt)("inlineCode",{parentName:"p"},"\\"),") to escape quotes (",(0,r.kt)("inlineCode",{parentName:"p"},'"')," and ",(0,r.kt)("inlineCode",{parentName:"p"},"'"),"), commas (",(0,r.kt)("inlineCode",{parentName:"p"},","),"), and pipes (",(0,r.kt)("inlineCode",{parentName:"p"},"|"),")."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"NOTE:")," When excluding a client, you ",(0,r.kt)("strong",{parentName:"p"},"must")," place ",(0,r.kt)("inlineCode",{parentName:"p"},"~")," outside the quotes."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@||*^$client=127.0.0.1"),": unblock everything for localhost.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$client='Frank\\'s laptop'"),": block ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," for the client named ",(0,r.kt)("inlineCode",{parentName:"p"},"Frank's laptop")," only. Note that quote (",(0,r.kt)("inlineCode",{parentName:"p"},"'"),") in the name must be escaped.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$client=~'Mary\\'s\\, John\\'s\\, and Boris\\'s laptops'"),": block ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," for everyone except for the client named ",(0,r.kt)("inlineCode",{parentName:"p"},"Mary's, John's, and Boris's laptops"),". Note that comma (",(0,r.kt)("inlineCode",{parentName:"p"},","),") must be escaped as well.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$client=~Mom|~Dad|Kids"),": block ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," for ",(0,r.kt)("inlineCode",{parentName:"p"},"Kids"),", but not for ",(0,r.kt)("inlineCode",{parentName:"p"},"Mom")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Dad"),". This example demonstrates how to specify multiple clients in one rule.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$client=192.168.0.0/24"),": block ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," for all clients with IP addresses in the range from ",(0,r.kt)("inlineCode",{parentName:"p"},"192.168.0.0")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"192.168.0.255"),"."))),(0,r.kt)("h4",{id:"denyallow"},(0,r.kt)("inlineCode",{parentName:"h4"},"denyallow")),(0,r.kt)("p",null,"You can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"denyallow")," modifier to exclude domains from the blocking rule. To add multiple domains to one rule, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"|")," character as a separator."),(0,r.kt)("p",null,"The syntax is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$denyallow=domain1|domain2|...\n")),(0,r.kt)("p",null,"This modifier allows avoiding creating unnecessary exception rules when our blocking rule covers too many domains. You may want to block everything except for a couple of TLD domains. You could use the standard approach, i.e. rules like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"! Block everything.\n/.*/\n\n! Unblock a couple of TLDs.\n@@||com^\n@@||net^\n")),(0,r.kt)("p",null,"The problem with this approach is that this way you will also unblock tracking domains that are located on those TLDs (i.e. ",(0,r.kt)("inlineCode",{parentName:"p"},"google-analytics.com"),"). Here's how to solve this with ",(0,r.kt)("inlineCode",{parentName:"p"},"denyallow"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"*$denyallow=com|net\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"*$denyallow=com|net"),": block everything except for ",(0,r.kt)("inlineCode",{parentName:"p"},"*.com")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"*.net"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@*$denyallow=com|net"),": unblock everything except for ",(0,r.kt)("inlineCode",{parentName:"p"},"*.com")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"*.net"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$denyallow=sub.example.org"),". block ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"*.example.org")," but don't block ",(0,r.kt)("inlineCode",{parentName:"p"},"sub.example.org"),"."))),(0,r.kt)("h4",{id:"dnstype"},(0,r.kt)("inlineCode",{parentName:"h4"},"dnstype")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"dnstype")," modifier allows specifying DNS request or response type on which this rule will be triggered."),(0,r.kt)("p",null,"The syntax is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$dnstype=value1|value2|...\n$dnstype=~value1|~value2|~...\n")),(0,r.kt)("p",null,"The names of the types are case-insensitive, but are validated against a set of actual DNS resource record (RR) types."),(0,r.kt)("p",null,"Do not combine exclusion rules with inclusion ones. This:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$dnstype=~value1|value2\n")),(0,r.kt)("p",null,"is equivalent to this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$dnstype=value2\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$dnstype=AAAA"),": block DNS queries for the IPv6 addresses of ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$dnstype=~A|~CNAME"),": only allow ",(0,r.kt)("inlineCode",{parentName:"p"},"A")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"CNAME")," DNS queries for ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org"),", block out the rest."))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"NOTE:")," Before version ",(0,r.kt)("strong",{parentName:"p"},"v0.108.0,")," AdGuard Home would use the type of the request to filter the response records, as opposed to the type of the response record itself.  That caused issues, since that meant that you could not write rules that would allow certain ",(0,r.kt)("inlineCode",{parentName:"p"},"CNAME")," records in responses in ",(0,r.kt)("inlineCode",{parentName:"p"},"A")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"AAAA")," requests. In ",(0,r.kt)("strong",{parentName:"p"},"v0.108.0")," that behaviour was changed, so now this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"||canon.example.com^$dnstype=~CNAME\n")),(0,r.kt)("p",null,"allows you to avoid filtering of the following response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"ANSWERS:\n->  example.com\n    canonical name = canon.example.com.\n    ttl = 60\n->  canon.example.com\n    internet address = 1.2.3.4\n    ttl = 60\n")),(0,r.kt)("h4",{id:"dnsrewrite"},(0,r.kt)("inlineCode",{parentName:"h4"},"dnsrewrite")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"dnsrewrite")," response modifier allows replacing the content of the response to the DNS request for the matching hosts. Note that this modifier in AdGuard Home works in all rules, but in Private AdGuard DNS \u2014 only in custom ones."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Rules with the ",(0,r.kt)("inlineCode",{parentName:"strong"},"dnsrewrite")," response modifier have higher priority than other rules in AdGuard Home.")),(0,r.kt)("p",null,"The shorthand syntax is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$dnsrewrite=1.2.3.4\n$dnsrewrite=abcd::1234\n$dnsrewrite=example.net\n$dnsrewrite=REFUSED\n")),(0,r.kt)("p",null,"The keywords MUST be in all caps (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"NOERROR"),"). Keyword rewrites take precedence over the other and will result in an empty response with an appropriate response code."),(0,r.kt)("p",null,"The full syntax is of the form ",(0,r.kt)("inlineCode",{parentName:"p"},"RCODE;RRTYPE;VALUE"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$dnsrewrite=NOERROR;A;1.2.3.4\n$dnsrewrite=NOERROR;AAAA;abcd::1234\n$dnsrewrite=NOERROR;CNAME;example.net\n$dnsrewrite=REFUSED;;\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"$dnsrewrite")," modifier with the ",(0,r.kt)("inlineCode",{parentName:"p"},"NOERROR")," response code may also has empty ",(0,r.kt)("inlineCode",{parentName:"p"},"RRTYPE")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"VALUE")," fields."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"CNAME")," one is special because AdGuard Home will resolve the host and add its info to the response. That is, if ",(0,r.kt)("inlineCode",{parentName:"p"},"example.net")," has IP ",(0,r.kt)("inlineCode",{parentName:"p"},"1.2.3.4"),", and the user has this in their filter rules:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"||example.com^$dnsrewrite=example.net\n! Or:\n||example.com^$dnsrewrite=NOERROR;CNAME;example.net\n")),(0,r.kt)("p",null,"then the response will be something like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nslookup example.com my.adguard.local\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"Server: my.adguard.local\nAddress: 127.0.0.1#53\n\nNon-authoritative answer:\nexample.com canonical name = example.net.\nName: example.net\nAddress: 1.2.3.4\n")),(0,r.kt)("p",null,"Next, the ",(0,r.kt)("inlineCode",{parentName:"p"},"CNAME")," rewrite. After that, all other records' values are summed as one response, so this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"||example.com^$dnsrewrite=NOERROR;A;1.2.3.4\n||example.com^$dnsrewrite=NOERROR;A;1.2.3.5\n")),(0,r.kt)("p",null,"will result in a response with two ",(0,r.kt)("inlineCode",{parentName:"p"},"A")," records."),(0,r.kt)("p",null,"Currently supported RR types with examples:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||4.3.2.1.in-addr.arpa^$dnsrewrite=NOERROR;PTR;example.net.")," adds a ",(0,r.kt)("inlineCode",{parentName:"p"},"PTR"),"record for reverse DNS. Reverse DNS requests for ",(0,r.kt)("inlineCode",{parentName:"p"},"1.2.3.4")," to the DNS server will result in ",(0,r.kt)("inlineCode",{parentName:"p"},"example.net"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"NOTE:")," the IP MUST be in reverse order. See ",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc1035#section-3.5"},"RFC 1035"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NOERROR;A;1.2.3.4")," adds an ",(0,r.kt)("inlineCode",{parentName:"p"},"A")," record with the value ",(0,r.kt)("inlineCode",{parentName:"p"},"1.2.3.4"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NOERROR;AAAA;abcd::1234")," adds an ",(0,r.kt)("inlineCode",{parentName:"p"},"AAAA")," record with the value ",(0,r.kt)("inlineCode",{parentName:"p"},"abcd::1234"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NOERROR;CNAME;example.org")," adds a ",(0,r.kt)("inlineCode",{parentName:"p"},"CNAME")," record. Voir l'explication ci-dessus.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NOERROR;HTTPS;32 example.com alpn=h3")," adds an ",(0,r.kt)("inlineCode",{parentName:"p"},"HTTPS")," record. Only a subset of parameter values is supported: values must be ",(0,r.kt)("inlineCode",{parentName:"p"},"contiguous")," and, where a ",(0,r.kt)("inlineCode",{parentName:"p"},"value-list")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"expected"),", only one value is currently supported:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-none"},'ipv4hint=127.0.0.1             // Supported.\nipv4hint="127.0.0.1"           // Unsupported.\nipv4hint=127.0.0.1,127.0.0.2   // Unsupported.\nipv4hint="127.0.0.1,127.0.0.2" // Unsupported.\n')),(0,r.kt)("p",{parentName:"li"},"This will be changed in the future.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NOERROR;MX;32 example.mail")," adds an ",(0,r.kt)("inlineCode",{parentName:"p"},"MX")," record with precedence value ",(0,r.kt)("inlineCode",{parentName:"p"},"32")," and exchange value ",(0,r.kt)("inlineCode",{parentName:"p"},"example.mail"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NOERROR;SVCB;32 example.com alpn=h3")," adds a ",(0,r.kt)("inlineCode",{parentName:"p"},"SVCB")," value. Voir l'exemple ",(0,r.kt)("inlineCode",{parentName:"p"},"HTTPS")," ci-dessus.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NOERROR;TXT;hello_world")," ajoute un enregistrement ",(0,r.kt)("inlineCode",{parentName:"p"},"TXT")," avec la valeur ",(0,r.kt)("inlineCode",{parentName:"p"},"hello_world"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||_svctype._tcp.example.com^$dnsrewrite=NOERROR;SRV;10 60 8080 example.com")," ajoute un enregistrement ",(0,r.kt)("inlineCode",{parentName:"p"},"SRV")," avec la valeur de priorit\xe9 ",(0,r.kt)("inlineCode",{parentName:"p"},"10"),", la valeur de pond\xe9ration ",(0,r.kt)("inlineCode",{parentName:"p"},"60"),", le port",(0,r.kt)("inlineCode",{parentName:"p"},"8080"),"et la valeur cible ",(0,r.kt)("inlineCode",{parentName:"p"},"example.com"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com^$dnsrewrite=NXDOMAIN;;")," r\xe9pond par un code ",(0,r.kt)("inlineCode",{parentName:"p"},"NXDOMAIN"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$dnstype=AAAA,denyallow=example.org,dnsrewrite=NOERROR\xa0;;")," fait retour avec des r\xe9ponses ",(0,r.kt)("inlineCode",{parentName:"p"},"NOERROR")," vides pour toutes requ\xeates ",(0,r.kt)("inlineCode",{parentName:"p"},"AAA")," sauf celles pour ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org"),"."))),(0,r.kt)("p",null,"Les r\xe8gles d'exception suppriment une ou toutes les r\xe8gles\xa0:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@||example.com^$dnsrewrite")," supprime toutes les r\xe8gles de r\xe9\xe9criture DNS.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@||example.com^$dnsrewrite=1.2.3.4")," supprime la r\xe8gle de r\xe9\xe9criture DNS qui ajoute un enregistrement ",(0,r.kt)("inlineCode",{parentName:"p"},"A")," avec la valeur ",(0,r.kt)("inlineCode",{parentName:"p"},"1.2.3.4"),"."))),(0,r.kt)("h4",{id:"important"},(0,r.kt)("inlineCode",{parentName:"h4"},"important")),(0,r.kt)("p",null,"Le modificateur ",(0,r.kt)("inlineCode",{parentName:"p"},"important")," appliqu\xe9 \xe0 une r\xe8gle augmente sa priorit\xe9 sur toute autre r\xe8gle sans le modificateur. M\xeame sur les r\xe8gles d'exceptions de base."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Dans cet exemple\xa0:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-none"},"||exemple.org^$important\n@@||exemple.org^\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$important")," bloquera toutes les requ\xeates vers ",(0,r.kt)("inlineCode",{parentName:"p"},"*.example.org")," malgr\xe9 la r\xe8gle d'exception.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Dans cet exemple\xa0:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-none"},"||example.org^$important\n@@||example.org^$important\n")),(0,r.kt)("p",{parentName:"li"},"la r\xe8gle d'exception comporte \xe9galement le modificateur ",(0,r.kt)("inlineCode",{parentName:"p"},"important")," , donc \xe7a doit marcher."))),(0,r.kt)("h4",{id:"badfilter"},(0,r.kt)("inlineCode",{parentName:"h4"},"badfilter")),(0,r.kt)("p",null,"Les r\xe8gles avec le modificateur ",(0,r.kt)("inlineCode",{parentName:"p"},"badfilter")," d\xe9sactivent les autres r\xe8gles de base auxquelles elles se r\xe9f\xe8rent. Cela signifie que le texte de la r\xe8gle d\xe9sactiv\xe9e doit correspondre au texte de la r\xe8gle ",(0,r.kt)("inlineCode",{parentName:"p"},"badfilter")," (sans le modificateur ",(0,r.kt)("inlineCode",{parentName:"p"},"badfilter"),")."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.com$badfilter")," d\xe9sactive ",(0,r.kt)("inlineCode",{parentName:"p"},"||example.com"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@@||example.org^$badfilter")," d\xe9sactive ",(0,r.kt)("inlineCode",{parentName:"p"},"@@||example.org^"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"REMARQUE :")," Le modificateur ",(0,r.kt)("inlineCode",{parentName:"p"},"badfilter")," ne fonctionne pas actuellement avec les r\xe8gles de style ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/hosts"),". ",(0,r.kt)("inlineCode",{parentName:"p"},"127.0.0.1 example.org$badfilter")," ne d\xe9sactivera ",(0,r.kt)("strong",{parentName:"p"},"pas")," la r\xe8gle d'origine ",(0,r.kt)("inlineCode",{parentName:"p"},"127.0.0.1 example.org"),"."))),(0,r.kt)("h4",{id:"ctag"},(0,r.kt)("inlineCode",{parentName:"h4"},"ctag")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The ",(0,r.kt)("inlineCode",{parentName:"strong"},"ctag")," modifier can only be used in AdGuard Home.")),(0,r.kt)("p",null,"It allows to block domains only for specific types of DNS client tags. You can assign tags to clients in the AdGuard Home UI. In the future, we plan to assign tags automatically by analyzing the behavior of each client."),(0,r.kt)("p",null,"The syntax is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$ctag=value1|value2|...\n")),(0,r.kt)("p",null,"If one of client's tags matches the ",(0,r.kt)("inlineCode",{parentName:"p"},"ctag")," values, this rule applies to the client. The syntax for exclusion is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"$ctag=~value1|~value2|...\n")),(0,r.kt)("p",null,"If one of client's tags matches the exclusion ",(0,r.kt)("inlineCode",{parentName:"p"},"ctag")," values, this rule doesn't apply to the client."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples :")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$ctag=device_pc|device_phone"),": block ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," for clients tagged as ",(0,r.kt)("inlineCode",{parentName:"p"},"device_pc")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"device_phone"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"||example.org^$ctag=~device_phone"),": block ",(0,r.kt)("inlineCode",{parentName:"p"},"example.org")," for all clients except those tagged as ",(0,r.kt)("inlineCode",{parentName:"p"},"device_phone"),"."))),(0,r.kt)("p",null,"The list of allowed tags:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"By device type:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_audio"),": audio devices."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_camera"),": cameras."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_gameconsole"),": game consoles."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_laptop"),": laptops."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_nas"),": NAS (Network-attached Storages)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_pc"),": PCs."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_phone"),": phones."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_printer"),": printers."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_securityalarm"),": security alarms."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_tablet"),": tablets."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_tv"),": TVs."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"device_other"),": other devices."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Par syst\xe8me d'exploitation\xa0:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"os_android"),": Android."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"os_ios"),": iOS."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"os_linux"),": Linux."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"os_macos"),": macOS."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"os_windows"),": Windows."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"os_other"),": autres syst\xe8mes d'exploitation."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Par groupe d'utilisateurs\xa0:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"user_admin"),": administrateurs."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"user_regular"),": utilisateurs r\xe9guliers."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"user_child"),": enfants.")))),(0,r.kt)("h2",{id:"etc-hosts-syntax"},(0,r.kt)("inlineCode",{parentName:"h2"},"/etc/hosts"),"-Style Syntaxe"),(0,r.kt)("p",null,"Pour chaque h\xf4te, une seule ligne doit \xeatre pr\xe9sente avec les informations suivantes\xa0:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"IP_address canonical_hostname [aliases...]\n")),(0,r.kt)("p",null,"Les champs des entr\xe9es sont s\xe9par\xe9s par un nombre d'espaces ou de tabulations. Le texte commen\xe7ant par le caract\xe8re ",(0,r.kt)("inlineCode",{parentName:"p"},"#")," jusqu'\xe0 la fin de la ligne est un commentaire et est ignor\xe9."),(0,r.kt)("p",null,"Les noms d'h\xf4te ne peuvent contenir que des caract\xe8res alphanum\xe9riques, des signes tiret moins (",(0,r.kt)("inlineCode",{parentName:"p"},"-"),") et des points (",(0,r.kt)("inlineCode",{parentName:"p"},"."),"). Ils doivent commencer par un caract\xe8re alphab\xe9tique et se terminer par un caract\xe8re alphanum\xe9rique. Les alias facultatifs permettent des changements de nom, des orthographes alternatives, des noms d'h\xf4te plus courts ou des noms d'h\xf4te g\xe9n\xe9riques (par exemple, ",(0,r.kt)("inlineCode",{parentName:"p"},"localhost"),")."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"# This is a comment\n127.0.0.1 example.org example.info\n127.0.0.1 example.com\n127.0.0.1 example.net # this is also a comment\n")),(0,r.kt)("p",null,"In AdGuard Home, the IP addresses are used to respond to DNS queries for these domains. In Private AdGuard DNS, these addresses are simply blocked."),(0,r.kt)("h2",{id:"domains-only-syntax"},"Domains-Only Syntax"),(0,r.kt)("p",null,"A simple list of domain names, one name per line."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-none"},"# This is a comment\nexample.com\nexample.org\nexample.net # this is also a comment\n")),(0,r.kt)("p",null,"If a string is not a valid domain (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"*.example.org"),"), AdGuard Home will consider it to be an ",(0,r.kt)("a",{parentName:"p",href:"#adblock-style-syntax"},"Adblock-style")," rule."),(0,r.kt)("h2",{id:"hostlists-compiler"},"Hostlists Compiler"),(0,r.kt)("p",null,"If you are maintaining a blocklist and use different sources in it, ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/HostlistCompiler"},"Hostlists compiler")," may be useful to you. It is a simple tool that makes it easier to compile a hosts blocklist compatible with AdGuard Home, Private AdGuard DNS or any other AdGuard product with DNS filtering."),(0,r.kt)("p",null,"What it's capable of:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Compile a single blocklist from multiple sources.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Exclude the rules you don't need.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Cleanup the resulting list: deduplicate, remove invalid rules, and compress the list."))))}c.isMDXComponent=!0}}]);